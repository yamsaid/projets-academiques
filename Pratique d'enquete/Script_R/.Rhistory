geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~cycle_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), '%')),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Taux de participation par année et cycle",
x = "Année d'étude",
y = "Pourcentage")
ggplot(res7, aes(x = année_cycle_rec, y = pourcentage, fill = qualite_rep)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~cycle_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), '%')),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "La qualité de la nourriture",
x = "",
y = " ")
res7<- base_ru %>%
group_by(cycle_etude,année_cycle_rec,qualite_rep)%>%
summarise(n = n(), .groups = "drop") %>%
group_by(cycle_etude,année_cycle_rec) %>%
mutate(pourcentage = n / sum(n) * 100)
res7
ggplot(res7, aes(x = année_cycle_rec, y = pourcentage, fill = qualite_rep)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~cycle_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), '%')),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "La qualité de la nourriture",
x = "",
y = " ")
ggplot(budget_moyen, aes(x = année_cycle_rec, y = moyen, fill = année_cycle_rec)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~filiere_etude) +
geom_text(aes(label = paste0(round(moyen, 2))),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le budget mensuel moyen alloué au RU",
x = "",
y = " ")
View(base)
base_nru <- base %>%
filter(utilis_serv_ru == "Non, je ne fréquente pas!")
library(dplyr)
library(questionr)
library(ggplot2)
base  <- read.csv("base.csv",sep = ";")
base<- base[-c(44,52,53,54,55)]
colnoms<-c( "consentement",
"utilis_serv_ru",
"sexe",
"bnfc_aide",
"aide_type",
"cycle_etude",
"année_cycle",
"filiere_etude",
"autre_filiere",
"cite_univ",
"regime_al",
"regime_al_precis",
"frequence",
"satisfact",
"prix_repas",
"qualite_rep",
"quanti_rep",
"choix_menus",
"Haricot",
"Riz_sauce",
"Riz_gras",
"Degue",
"Yaourt",
"Crudite",
"Hambourger",
"Gonre",
"Soupe",
"Gateau",
"Alloco",
"Couscous",
"Haricvert",
"To",
"Spaguetti",
"Macoroni",
"nombr_plat",
"plat_varie",
"hygiene_ru",
"accueil_per",
"temps_at",
"rapport_qual_pri",
"budget_mens",
"suggestion",
"sugges_preciser",
"rais_Qual_med",
"Prix_eleve",
"long_attente",
"Hor_inadapt",
"Manq_hygiene",
"fast_food",
"Autres"
)
# Renommage des colonnes
colnames(base)<-colnoms
## Recodage de base$consentement en base$consentement_rec
base$consentement_rec <- base$consentement
base$consentement_rec[base$consentement == "Non, je ne veux pas y participer"] <- "non"
base$consentement_rec[base$consentement == "Oui, je  veux y participer"] <- "oui"## Recodage de base$consentement en base$consentement_rec)
## Recodage de base$utilis_serv_ru en base$utilis_serv_ru_rec
base$utilis_serv_ru_rec <- base$utilis_serv_ru
base$utilis_serv_ru_rec[base$utilis_serv_ru == "Non, je ne fréquente pas!"] <- "non"
base$utilis_serv_ru_rec[base$utilis_serv_ru == "Oui, je fréquente"] <- "oui"
## Recodage de base$sexe en base$sexe_rec
base$sexe_rec <- base$sexe
base$sexe_rec[base$sexe == "Féminin"] <- "femme"
base$sexe_rec[base$sexe == "Masculin"] <- "homme"
resu<-base %>%
group_by(consentement_rec) %>%
summarise(effectif = n()) %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
ggplot(resu, aes(x = consentement_rec, y = pourcentage, fill = consentement_rec)) +
geom_bar(stat = "identity") +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5), size = 3) +
labs(title = "Taux de participation à d'étude",
x ="",
y = "Pourcentage") +
scale_fill_manual(values = c("oui" = "steelblue", "non" = "tomato")) +
theme_minimal()
resume<-base %>%
group_by(utilis_serv_ru) %>%
summarise(effectif = n()) %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
ggplot(resume, aes(x = utilis_serv_ru, y = pourcentage, fill = utilis_serv_ru)) +
geom_bar(stat = "identity") +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5), size = 3) +
labs(title = "Taux de fréquentation aux services du RU",
x ="",
y = "Pourcentage")
base_ru <- base %>%
filter(utilis_serv_ru == "Oui, je fréquente")
base_nru <- base %>%
filter(utilis_serv_ru == "Non, je ne fréquente pas!")
base_nru
View(base_nru)
irec()
## Recodage de base_nru$long_attente en base_nru$long_attente_rec
base_nru$long_attente_rec <- as.character(base_nru$long_attente)
base_nru$long_attente_rec[base_nru$long_attente == "0"] <- "non"
base_nru$long_attente_rec[base_nru$long_attente == "1"] <- "oui"
base_nru$Manq_hygiene_rec <- as.character(base_nru$Manq_hygiene)
base_nru$Manq_hygiene_rec[base_nru$Manq_hygiene == "0"] <- "non"
base_nru$Manq_hygiene_rec[base_nru$Manq_hygiene == "1"] <- "oui"
irec()
irec()## Recodage de base_nru$Hor_inadapt en base_nru$Hor_inadapt_rec
base_nru$Hor_inadapt_rec <- as.character(base_nru$Hor_inadapt)
base_nru$Hor_inadapt_rec[base_nru$Hor_inadapt == "0"] <- "non"
base_nru$Hor_inadapt_rec[base_nru$Hor_inadapt == "1"] <- "oui"
irec()## Recodage de base_nru$Hor_inadapt en base_nru$Hor_inadapt_rec
base_nru$Hor_inadapt_rec <- as.character(base_nru$Hor_inadapt)
base_nru$Hor_inadapt_rec[base_nru$Hor_inadapt == "0"] <- "non"
base_nru$Hor_inadapt_rec[base_nru$Hor_inadapt == "1"] <- "oui"
library(dplyr)
library(questionr)
library(ggplot2)
base  <- read.csv("base.csv",sep = ";")
base<- base[-c(44,52,53,54,55)]
colnoms<-c( "consentement",
"utilis_serv_ru",
"sexe",
"bnfc_aide",
"aide_type",
"cycle_etude",
"année_cycle",
"filiere_etude",
"autre_filiere",
"cite_univ",
"regime_al",
"regime_al_precis",
"frequence",
"satisfact",
"prix_repas",
"qualite_rep",
"quanti_rep",
"choix_menus",
"Haricot",
"Riz_sauce",
"Riz_gras",
"Degue",
"Yaourt",
"Crudite",
"Hambourger",
"Gonre",
"Soupe",
"Gateau",
"Alloco",
"Couscous",
"Haricvert",
"To",
"Spaguetti",
"Macoroni",
"nombr_plat",
"plat_varie",
"hygiene_ru",
"accueil_per",
"temps_at",
"rapport_qual_pri",
"budget_mens",
"suggestion",
"sugges_preciser",
"rais_Qual_med",
"Prix_eleve",
"long_attente",
"Hor_inadapt",
"Manq_hygiene",
"fast_food",
"Autres"
)
# Renommage des colonnes
colnames(base)<-colnoms
## Recodage de base$consentement en base$consentement_rec
base$consentement_rec <- base$consentement
base$consentement_rec[base$consentement == "Non, je ne veux pas y participer"] <- "non"
base$consentement_rec[base$consentement == "Oui, je  veux y participer"] <- "oui"## Recodage de base$consentement en base$consentement_rec)
## Recodage de base$utilis_serv_ru en base$utilis_serv_ru_rec
base$utilis_serv_ru_rec <- base$utilis_serv_ru
base$utilis_serv_ru_rec[base$utilis_serv_ru == "Non, je ne fréquente pas!"] <- "non"
base$utilis_serv_ru_rec[base$utilis_serv_ru == "Oui, je fréquente"] <- "oui"
## Recodage de base$sexe en base$sexe_rec
base$sexe_rec <- base$sexe
base$sexe_rec[base$sexe == "Féminin"] <- "femme"
base$sexe_rec[base$sexe == "Masculin"] <- "homme"
resu<-base %>%
group_by(consentement_rec) %>%
summarise(effectif = n()) %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
ggplot(resu, aes(x = consentement_rec, y = pourcentage, fill = consentement_rec)) +
geom_bar(stat = "identity") +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5), size = 3) +
labs(title = "Taux de participation à d'étude",
x ="",
y = "Pourcentage") +
scale_fill_manual(values = c("oui" = "steelblue", "non" = "tomato")) +
theme_minimal()
resume<-base %>%
group_by(utilis_serv_ru) %>%
summarise(effectif = n()) %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
ggplot(resume, aes(x = utilis_serv_ru, y = pourcentage, fill = utilis_serv_ru)) +
geom_bar(stat = "identity") +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5), size = 3) +
labs(title = "Taux de fréquentation aux services du RU",
x ="",
y = "Pourcentage")
base_ru <- base %>%
filter(utilis_serv_ru == "Oui, je fréquente")
## Recodage de base$aide_type en base$aide_type_rec
base_ru$aide_type_rec <- base_ru$aide_type
base_ru$aide_type_rec[base_ru$aide_type == ""] <- "Aucune_aide"
## Recodage de base_ru$année_cycle en base_ru$année_cycle_rec
base_ru$année_cycle_rec <- base_ru$année_cycle
base_ru$année_cycle_rec[base_ru$année_cycle == "1ere"] <- "1ere année"
base_ru$année_cycle_rec[base_ru$année_cycle == "2e"] <- "2e année"
base_ru$année_cycle_rec[base_ru$année_cycle == "3e"] <- "3e année"
resume <- base_ru %>%
group_by(aide_type_rec) %>%
summarise(n = n(), .groups = "drop") %>%
mutate(pourcentage = n / sum(n) * 100)
ggplot(resume, aes(x = "", y = pourcentage, fill = aide_type_rec)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y") +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5)) +
labs(title = "Répartition des types d'aide parmi les usagers du service RU",
fill = "Type d'aide") +
theme_void()
resume <- base_ru %>%
group_by(cycle_etude) %>%
summarise(n = n(), .groups = "drop") %>%
mutate(pourcentage = n / sum(n) * 100)
ggplot(resume, aes(x = "", y = pourcentage, fill = cycle_etude)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y") +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5)) +
labs(title = "Répartition des types d'aide parmi les usagers du service RU",
fill = "Type d'aide") +
theme_void()
resume <- base_ru %>%
group_by(filiere_etude) %>%
summarise(n = n(), .groups = "drop") %>%
mutate(pourcentage = n / sum(n) * 100)
ggplot(resume, aes(x = "", y = pourcentage, fill = filiere_etude)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y") +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5)) +
labs(title = "Répartition des types d'aide parmi les usagers du service RU",
fill = "Type d'aide") +
theme_void()
res<- base_ru %>%
group_by(cycle_etude,année_cycle_rec)%>%
summarise(n = n(), .groups = "drop") %>%
mutate(pourcentage = n / sum(n) * 100)
res
ggplot(res, aes(x = année_cycle_rec, y = pourcentage, fill = année_cycle_rec)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~cycle_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Taux de participation par année et cycle",
x = "Année d'étude",
y = "Pourcentage") +
scale_fill_brewer(palette = "Set2") +  # ou "Pastel1", "Dark2", etc.
theme_minimal()
res2<- base_ru %>%
group_by(satisfact)%>%
summarise(n = n(), .groups = "drop") %>%
mutate(pourcentage = n / sum(n) * 100)
res2
ggplot(res2, aes(x = satisfact, y = pourcentage, fill = satisfact)) +
geom_bar(stat = "identity", position = "dodge") +
#facet_wrap(~cycle_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le niveau de satisfaction générale ",
x ="Niveau",
y = "Pourcentage") +
scale_fill_manual(values = c("satisfait" = "steelblue", "Très satisfait" = "tomato", "Pas du tout satisfait"="green","Peu satisfait"="orange"))
res3<- base_ru %>%
group_by(cycle_etude,satisfact)%>%
summarise(n = n(), .groups = "drop") %>%
group_by(cycle_etude) %>%
mutate(pourcentage = n / sum(n) * 100)
res3
ggplot(res3, aes(x = satisfact, y = pourcentage, fill = satisfact)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~cycle_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le niveau de satisfaction générale par cycle d'étude  ",
x =" ",
y = "Pourcentage") +
scale_fill_manual(values = c("satisfait" = "steelblue", "Très satisfait" = "tomato", "Pas du tout satisfait"="green","Peu satisfait"="orange")) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
res4<- base_ru %>%
group_by(filiere_etude,satisfact)%>%
summarise(n = n(), .groups = "drop") %>%
group_by(filiere_etude) %>%
mutate(pourcentage = n / sum(n) * 100)
res4
ggplot(res4, aes(x = satisfact, y = pourcentage, fill = satisfact)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~filiere_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le niveau de satisfaction généralepar filière ",
x =" ",
y = "Pourcentage") +
scale_fill_manual(values = c("satisfait" = "steelblue", "Très satisfait" = "tomato", "Pas du tout satisfait"="green","Peu satisfait"="orange")) +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
ggplot(res4, aes(x = filiere_etude, y = pourcentage, fill = satisfact)) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(labels = scales::percent) +
labs(title = "Satisfaction par filière par filière",
x = "Filière", y = "Proportion")
res5<- base_ru %>%
group_by(filiere_etude,quanti_rep)%>%
summarise(n = n(), .groups = "drop") %>%
group_by(filiere_etude) %>%
mutate(pourcentage = n / sum(n) * 100)
res5
ggplot(res5, aes(x = quanti_rep, y = pourcentage, fill = quanti_rep)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~filiere_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le niveau de satisfaction de la quantité du repas ",
x =" ",
y = "Pourcentage")+
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
res6<- base_ru %>%
group_by(filiere_etude,qualite_rep)%>%
summarise(n = n(), .groups = "drop") %>%
group_by(filiere_etude) %>%
mutate(pourcentage = n / sum(n) * 100)
res6
ggplot(res6, aes(x = qualite_rep, y = pourcentage, fill = qualite_rep)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~filiere_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le niveau de satisfaction de la quantité du repas ",
x =" ",
y = "Pourcentage")+
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
res7<- base_ru %>%
group_by(cycle_etude,année_cycle_rec,qualite_rep)%>%
summarise(n = n(), .groups = "drop") %>%
group_by(cycle_etude,année_cycle_rec) %>%
mutate(pourcentage = n / sum(n) * 100)
res7
ggplot(res7, aes(x = année_cycle_rec, y = pourcentage, fill = qualite_rep)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~cycle_etude) +
geom_text(aes(label = paste0(round(pourcentage, 1), '%')),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "La qualité de la nourriture",
x = "",
y = " ")
resum<- base_ru %>%
group_by(temps_at)%>%
summarise(effectif = n(), .groups = "drop") %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
resum
ggplot(resum, aes(x = "", y = effectif, fill = temps_at)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y") +
geom_text(aes(label = paste0(effectif)),
position = position_stack(vjust = 0.5)) +
labs(title = "Répartition des types d'aide parmi les usagers du service RU",
fill = "Temps d'attente") +
theme_void()
resum2<- base_ru %>%
group_by(hygiene_ru)%>%
summarise(effectif = n(), .groups = "drop") %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
resum2
ggplot(resum2, aes(x = "", y = effectif, fill = hygiene_ru)) +
geom_bar(stat = "identity", width = 3) +
coord_polar("y") +  # transforme en cercle
#theme_void() +      # supprime les axes et grilles
geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
position = position_stack(vjust = 0.5)) +
labs(title = "Zone polaire",) +
theme(legend.title = element_blank())
resum3<- base_ru %>%
group_by(accueil_per)%>%
summarise(effectif = n(), .groups = "drop") %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
resum3
ggplot(resum3, aes(x = accueil_per, y = pourcentage, fill = accueil_per)) +
geom_bar(stat = "identity", position = "dodge") +
#facet_wrap(~accueil_per) +
geom_text(aes(label = paste0(round(pourcentage, 1), '%')),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le niveau de satisfaction de l'accueil du personnel",
x = "",
y = "Pourcentage")
budget_moyen <- base_ru %>%
group_by(filiere_etude,année_cycle_rec) %>%
summarise(moyen = mean(budget_mens, na.rm = TRUE))
budget_moyen
echo:FALSE
ggplot(budget_moyen, aes(x = année_cycle_rec, y = moyen, fill = année_cycle_rec)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~filiere_etude) +
geom_text(aes(label = paste0(round(moyen, 2))),
position = position_dodge(width = 0.9), vjust = -0.3, size = 3) +
labs(title = "Le budget mensuel moyen alloué au RU",
x = "",
y = " ")
base_nru <- base %>%
filter(utilis_serv_ru == "Non, je ne fréquente pas!")
irec()
## Recodage de base_nru$long_attente en base_nru$long_attente_rec
base_nru$long_attente_rec <- as.character(base_nru$long_attente)
base_nru$long_attente_rec[base_nru$long_attente == "0"] <- "non"
base_nru$long_attente_rec[base_nru$long_attente == "1"] <- "oui"
base_nru$Manq_hygiene_rec <- as.character(base_nru$Manq_hygiene)
base_nru$Manq_hygiene_rec[base_nru$Manq_hygiene == "0"] <- "non"
base_nru$Manq_hygiene_rec[base_nru$Manq_hygiene == "1"] <- "oui"
## Recodage de base_nru$long_attente en base_nru$long_attente_rec
base_nru$long_attente_rec <- as.character(base_nru$long_attente)
base_nru$long_attente_rec[base_nru$long_attente == "0"] <- "non"
base_nru$long_attente_rec[base_nru$long_attente == "1"] <- "oui"
base_nru$Manq_hygiene_rec <- as.character(base_nru$Manq_hygiene)
base_nru$Manq_hygiene_rec[base_nru$Manq_hygiene == "0"] <- "non"
base_nru$Manq_hygiene_rec[base_nru$Manq_hygiene == "1"] <- "oui"
## Recodage de base_nru$Hor_inadapt en base_nru$Hor_inadapt_rec
base_nru$Hor_inadapt_rec <- as.character(base_nru$Hor_inadapt)
base_nru$Hor_inadapt_rec[base_nru$Hor_inadapt == "0"] <- "non"
base_nru$Hor_inadapt_rec[base_nru$Hor_inadapt == "1"] <- "oui"
## Recodage de base_nru$rais_Qual_med en base_nru$rais_Qual_med_rec
base_nru$rais_Qual_med_rec <- as.character(base_nru$rais_Qual_med)
base_nru$rais_Qual_med_rec[base_nru$rais_Qual_med == "0"] <- "non"
base_nru$rais_Qual_med_rec[base_nru$rais_Qual_med == "1"] <- "oui"
## Recodage de base_nru$Prix_eleve en base_nru$Prix_eleve_rec
base_nru$Prix_eleve_rec <- as.character(base_nru$Prix_eleve)
base_nru$Prix_eleve_rec[base_nru$Prix_eleve == "0"] <- "non"
table(base_nru$rais_Qual_med_rec)
resume<- base_nru %>%
group_by(rais_Qual_med_rec)%>%
summarise(effectif = n(), .groups = "drop") %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
resum3
resume<- base_nru %>%
group_by(rais_Qual_med_rec)%>%
summarise(effectif = n(), .groups = "drop") %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
resume
resume<- base_nru %>%
group_by(rais_Qual_med_rec,long_attente_rec)%>%
summarise(effectif = n(), .groups = "drop") %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
resume
resume<- base_nru %>%
group_by(long_attente_rec)%>%
summarise(effectif = n(), .groups = "drop") %>%
mutate(pourcentage = effectif / sum(effectif) * 100)
resume
